language: java

sudo: false

cache:
  directories:
  - "$HOME/.m2"

services:
- docker

install: skip

script:
#Build Attendance Service
- cd attendance/
- pip install -r requirements.txt
- docker build -t rajagupt/attendance .
#Build Management Service
- cd ../management/
- mvn clean verify
- docker build -t rajagupt/management .
#Build Metrics Service
- cd ../metrics/
- mvn clean verify
- docker build -t rajagupt/metrics .
#Build Reporting Service
- cd ../reporting/
- mvn clean verify
- docker build -t rajagupt/reporting .
#Build Admin UI
- cd ../upresent-admin/
- docker build -t rajagupt/upresent-admin .
#Build User Service
- cd ../user/
- mvn clean verify
- docker build -t rajagupt/user .
#Push Images to Docker Hub
- echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
- docker push rajagupt/attendance
- docker push rajagupt/management
- docker push rajagupt/metrics
- docker push rajagupt/reporting
- docker push rajagupt/upresent-admin
- docker push rajagupt/user
